<!DOCTYPE HTML>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="../css/style.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="http://www.google.com/cse/style/look/default.css" type="text/css" /> <!--Google Search at bottom-->
<title>HTH Blog: Updating SCCM Apps - The Fun and Easy Way (GUI)</title>

<!--For top menu-->
<link rel="stylesheet" type="text/css" href="../css/anylinkmenu.css" />
<script src="../javascript/menucontents.js"></script>
<script src="../javascript/anylinkmenu.js">
//***********************************************
//* AnyLink JS Drop Down Menu v2.0- Â© Dynamic Drive DHTML code library (www.dynamicdrive.com)
//* This notice MUST stay intact for legal use
//* Visit Project Page at http://www.dynamicdrive.com/dynamicindex1/dropmenuindex.htm for full source code
//***********************************************/
</script>
<script>
//anylinkmenu.init("menu_anchors_class") //Pass in the CSS class of anchor links (that contain a sub menu)
//Uncomment/comment these inits as needed based on your menu bar below.
anylinkmenu.init("menuanchorclass")
anylinkmenu.init("menuanchorclass2")
anylinkmenu.init("menuanchorclass3")
anylinkmenu.init("menuanchorclass4")
anylinkmenu.init("menuanchorclass5")
//anylinkmenu.init("menuanchorclass6")
//anylinkmenu.init("menuanchorclass7")
//anylinkmenu.init("menuanchorclass8")
</script>
<!--End for top menu-->

<style>
#content {width: 100%;} /* For pages without the left navbar - fills up entirety of page width */
</style>

</head>
<body>

<div id="capstonebar">

	<div id="capstonebar_inner">

    <!--Google Search Box, or search link if no javascript enabled-->
    <!--<div id="searchlink" style="float:right;"><a class="capstonebarlink" href="javascript:;" onClick="document.getElementById('cse-search-form').style.display='inline';">Search</a></div>
    <noscript><div id="searchlink" style="float:right;"><a class="capstonebarlink" href="searchresults.html">Search</a></div></noscript>

    <div id="cse-search-form" style="width:20%; float:right; display:none;">Loading</div>-->

    <!--***Drop Script code here***-->

    <!--End Google Search Box-->

    <p>
        <a href="../index.html"><img src="../images/hthlogo15.png" alt="HTH" title="HTH Home" width="15" height="15" /></a>&nbsp;&nbsp;
        <span class="capstonebarlinkcurrentpage">Hope This Helps</span>
        |&nbsp;<a class="capstonebarlink" href="https://anchor.fm/hope-this-helps" target="_blank">Anchor</a>
        |&nbsp;<a class="capstonebarlink" href="https://podcasts.apple.com/us/podcast/hope-this-helps/id1492373157" target="_blank">iTunes</a>
        |&nbsp;<a class="capstonebarlink" href="https://open.spotify.com/show/1Yedsm23LoF35w6LyivMmh" target="_blank">Spotify</a>
        |&nbsp;<a class="capstonebarlink" href="https://overcast.fm/itunes1492373157/hope-this-helps" target="_blank">Overcast</a>
        |&nbsp;<a class="capstonebarlink" href="https://twitter.com/HTHTHEPODCAST" target="_blank">Twitter</a>
        |&nbsp;<a class="capstonebarlink" href="https://www.twitch.tv/hopethishelps" target="_blank">Twitch</a>
        |&nbsp;<a class="capstonebarlink" href="https://anchor.fm/s/11b35770/podcast/rss" target="_blank">RSS</a>
		|&nbsp;<a class="capstonebarlink" href="https://reddit.com/r/hopethishelpspodcast" target="_blank">Reddit</a>
    </p>

	</div>

</div>




<div id="main_wrapper">

<div id = "header">
	<div id = "header_inner">

    <a href="../index.html"><img src="../images/logo.PNG" class="banner" alt="Logo"></a><br /><br />
    <!--If you want to use the image map code (commented out at bottom), add  usemap="#bannermap" to the end of the above image code.-->

    		<!-- Begin Navigation -->
            <!--The Rollover inserts are just for show, remove/insert them however you want.-->
            <div class="topnavbar" style="text-align:center;">
                <a href="../about.html" class="menuanchorclass" >About</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="../shownotes/index.html" class="menuanchorclass2" data-id="anylinkmenu1">Show Notes</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="../codesnippets/index.html" class="menuanchorclass3" >Code Snippets</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				<a href="../blog/index.html" class="menuanchorclass4" >Blog</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="../live.html" class="menuanchorclass5" >Live</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </div>
            <!-- End Navigation -->

    </div>
</div>

<!-- <div id = "nav">

	<div id = "nav_inner">

		<p><a class="leftnavlink" href="#">Link here</a></p>

	</div>

</div> -->

<div id = "content">

	<div id = "content_inner">

        <article>
        <h2>Updating SCCM Apps - The Fun and Easy Way (GUI)</h2>
        <h3>Author: Steve</h3>

        <h4>A follow-up to a topic from <a href="../shownotes/hth0008.html" target="_blank">HTH0008</a></h4>

        <p>There's a bunch of ways to skin a cat (don't do that though), but you want the most efficient method (seriously, don't skin a cat). SCCM provides a bunch of good and bad ways to update an application in your environment, some of which may require more overhead and nannying than others. I settled on a method that keeps things reasonably simple while ensuring your update will make it out to systems that already have the application deployed to them. Needless to say, I'm not preaching this as the end-all-be-all process, but rather, <span style="text-decoration: underline;"><strong>A</strong></span> working and usable process.</p>
        <p>Let's dive in!</p>
        <p>So, as you may or may not be aware, you will be dealing with MSI-based applications or Non-MSI "script" based applications most of the time. The process of updating an SCCM application varies slightly depending on whether it is an MSI application or not. MSI installers tend to feed Windows/SCCM a lot more handy information automatically as opposed to script-based installers where you need to fill in more blanks, figure out silent installation commands, do research on detection methods, and whatever else is necessary. I will cover both installer types.</p>
        
        <p>In these examples, we will assume you already have the application previously configured/deployed. An easy way to update it <strong>without</strong> re-deploying and reconfiguring it is to just update the content and deployment type. How you do this depends on whether it is an MSI installer or not.</p>

        <h4>Let's start with the non-MSI (script) based method. In this example, we will update Notepad++.</h4>
        <p>Let's first examine our source file structure. I tend to use a source file directory that is insensitive to version numbers. For example, I store the Notepad++ installer files in a folder called "Latest." I will also include a blank text file with the title being the version of the program so I know if it's current or not. See the below screenshot for a visual example if this isn't making much sense:</p>
        <p><img src="../images/sccmupdateguinonmsi01.png" style="height: 90%; width: 90%;" alt="Source File Directory Layout"></p>
        <p>As you can see above, you'll notice I have a few extra files in here as well. I use PowerShell scripts to cover the installation and uninstallation of this application, and will feed that information into the Deployment Type later on below. Also, I have a few plugins copied into the plugins directory, such as the Compare plugin and NppJumpList. I also keep track of these plugin versions via separate text files. These are optional of course.</p>
        <p>OK, so now that we've established the ground rules of the source file structure, let's start by getting the newest installer for Notepad++, download it to the above folder, replacing the existing npp.installer.exe (keep it as the same exact file name).</p>
        <p>In SCCM, go to your Application's Deployment Type and click "Update Content" either in the Ribbon menu or the Deployment Type tab's right click menu for the Deployment Type:</p>
        <p><img src="../images/sccmupdateguinonmsi02.png" style="height: 80%; width: 80%;" alt="Clicking 'Update Content' on Deployment Type"></p>
        <p>Confirm the content update when it asks:</p>
        <p><img src="../images/sccmupdateguinonmsi03.png" style="height: 70%; width: 70%;" alt="Confirming the Content Update"></p>
        <p>Go to your Application's properties, and update the version so it displays the right version in Software Center (this is visual only):</p>
        <p><img src="../images/sccmupdateguinonmsi04.png" style="height: 60%; width: 60%;" alt="Application Properties Menu"></p>
        <p><img src="../images/sccmupdateguinonmsi05.png" style="height: 90%; width: 90%;" alt="Application Properties"></p>
        <p>Go into the Deployment Type tab and click "edit" on the Deployment Type:</p>
        <p><img src="../images/sccmupdateguinonmsi06.png" style="height: 90%; width: 90%;" alt="Edit Deployment Type"></p>
        <p><strong>Reminder: In this example we're assuming your source file directory is insensitive to version numbers.</strong> <br />In this example, the content location is a path ending in a folder called "Latest" to allow for updated files/executables to be dropped in without application configuration disruption:</p>
        <p><img src="../images/sccmupdateguinonmsi07.png" style="height: 90%; width: 90%;" alt="DT Content Tab"></p>
        <p>Go to your Detection Method and edit your detection method's clause to reflect the new version. Please note this will vary from application to application, and will require some legwork on your part to determine the correct values. For Notepad++, it's pretty simple, as denoted below by a registry string:</p>
        <p><img src="../images/sccmupdateguinonmsi08.png" style="height: 90%; width: 90%;" alt="DT Detection Method Tab"></p>
        <p><img src="../images/sccmupdateguinonmsi09.png" style="height: 90%; width: 90%;" alt="DT Detection Rule/Clause"></p>
        <p>After that, you're done! Any existing deployment will reach out to computers and install the updated program. If a collection is put into a maintenance schedule, it will download the new content and install it at the next install window.</p>
        
        <h4>Now, let's use an MSI-based installer as our next example. We'll use PuTTY below:</h4>
        <p>Just like the non-MSI installer, our core goal will be to update/replace the old version's deployment type with the current version's deployment type.</p>
        <p>Just like before, download to your source file directory, replacing the installer. Again, making the file name version-agnostic here (and instead keeping track of the version via a text file) makes this really easy:</p>
        <p><img src="../images/sccmupdateguimsi01.png" style="height: 90%; width: 90%;" alt="Source File Directory Layout"></p>
        <p><br />Unlike the script-based installer, we need to first create a new Deployment Type:</p>
        <p><img src="../images/sccmupdateguimsi02.png" style="height: 90%; width: 90%;" alt="New MSI Deployment Type"></p>
        <p><br />Point it to your source MSI installer:</p>
        <p><img src="../images/sccmupdateguimsi03.png" style="height: 90%; width: 90%;" alt="Create Deployment Type Wizard - MSI Installer Path"></p>
        <p><br />Name it/set an installation program path if you wish (replace it with a powershell script call as needed)/etc:</p>
        <p><img src="../images/sccmupdateguimsi04.png" style="height: 90%; width: 90%;" alt="Create Deployment Type Wizard - General Info and Installation Program/Script Box"></p>
        <p><br />Confirm:</p>
        <p><img src="../images/sccmupdateguimsi05.png" style="height: 90%; width: 90%;" alt="Create Deployment Type Wizard - Confirm it all"></p>
        <p><br />Then, we need to delete the older/previous deployment type, leaving only the newest version's deployment type. The process is straightforward:</p>
        <p><img src="../images/sccmupdateguimsi06.png" style="height: 90%; width: 90%;" alt="Delete older MSI Deployment Type"></p>
        <p><br />Make sure only one remains:</p>
        <p><img src="../images/sccmupdateguimsi07.png" style="height: 90%; width: 90%;" alt="Confirm only one DT is left"></p>
        <p><br />Now, modify the Deployment Type Properties and adjust anything as needed if necessary (in the below example, I replaced the program command line path with a powershell script call. This is up to you depending on your style/environment):</p>
        <p><img src="../images/sccmupdateguimsi08.png" style="height: 90%; width: 90%;" alt="DT Properties - Programs Tab"></p>
        <p><br />After that, you're done! Any existing deployment will reach out to computers, those computers will fail the updated detection methods, and thus they will pull down and install the newly-updated application. Note that if a collection is put into a maintenance schedule, it will download the new content at the next refresh cycle, and install it at the next open install window.</p>
        
        <p>I hope this perspective helps you in not only understanding ways to update applications, but maybe save you time time and provide some efficiency in your application updates.</p>
        <p>I also wanted to save this for the very end, but all of this is also scriptable via PowerShell! Perhaps in a future blog post I will touch on how to make this possible.</p>
        <p>Hope this helps!</p>
        </article>
        
	</div>

</div>



<div id = "footer">

	<div id = "footer_inner">

    <!--Javascript footer, to edit this, edit "javascript/footer.js"-->
	<script src="../javascript/footer.js"></script>

    <noscript>
    It appears you have Javascript disabled in your browser or something is blocking it.<br />
    If you enable it, this site will have extra visual features. If not, that's cool too.
    </noscript>

	</div>

</div>


</div> <!--End Main Wrapper-->

    <!--Image map for above banner, makes different regions click to different links:-->
    <!--It's way down here because if it is put up above, it creates a weird clump of space-->
    <!--This is commented out because you probably won't need this, but it's here if you do. It makes parts of the top banner clickable in areas you specify.-->
    <!--<map name="bannermap">
  	<area shape="rect" coords="0,-1,600,199" href="index.html" alt="OSIL Home"/>
    <area shape="rect" coords="600,0,1024,200" href="http://www.something.com/" alt="Something" />
	</map>-->

</body>
</html>
