<!DOCTYPE HTML>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="../css/style.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="http://www.google.com/cse/style/look/default.css" type="text/css" /> <!--Google Search at bottom-->
<title>HTH Blog: PowerShell Advanced Functions</title>

<!--For top menu-->
<link rel="stylesheet" type="text/css" href="../css/anylinkmenu.css" />
<script src="../javascript/menucontents.js"></script>
<script src="../javascript/anylinkmenu.js">
//***********************************************
//* AnyLink JS Drop Down Menu v2.0- Â© Dynamic Drive DHTML code library (www.dynamicdrive.com)
//* This notice MUST stay intact for legal use
//* Visit Project Page at http://www.dynamicdrive.com/dynamicindex1/dropmenuindex.htm for full source code
//***********************************************/
</script>
<script>
//anylinkmenu.init("menu_anchors_class") //Pass in the CSS class of anchor links (that contain a sub menu)
//Uncomment/comment these inits as needed based on your menu bar below.
anylinkmenu.init("menuanchorclass")
anylinkmenu.init("menuanchorclass2")
anylinkmenu.init("menuanchorclass3")
anylinkmenu.init("menuanchorclass4")
anylinkmenu.init("menuanchorclass5")
//anylinkmenu.init("menuanchorclass6")
//anylinkmenu.init("menuanchorclass7")
//anylinkmenu.init("menuanchorclass8")
</script>
<!--End for top menu-->

<style>
#content {width: 100%;} /* For pages without the left navbar - fills up entirety of page width */
</style>

</head>
<body>

<div id="capstonebar">

	<div id="capstonebar_inner">

    <!--Google Search Box, or search link if no javascript enabled-->
    <!--<div id="searchlink" style="float:right;"><a class="capstonebarlink" href="javascript:;" onClick="document.getElementById('cse-search-form').style.display='inline';">Search</a></div>
    <noscript><div id="searchlink" style="float:right;"><a class="capstonebarlink" href="searchresults.html">Search</a></div></noscript>

    <div id="cse-search-form" style="width:20%; float:right; display:none;">Loading</div>-->

    <!--***Drop Script code here***-->

    <!--End Google Search Box-->

    <p>
        <a href="../index.html"><img src="../images/hthlogo15.png" alt="HTH" title="HTH Home" width="15" height="15" /></a>&nbsp;&nbsp;
        <span class="capstonebarlinkcurrentpage">Hope This Helps</span>
        |&nbsp;<a class="capstonebarlink" href="https://anchor.fm/hope-this-helps" target="_blank">Anchor</a>
        |&nbsp;<a class="capstonebarlink" href="https://podcasts.apple.com/us/podcast/hope-this-helps/id1492373157" target="_blank">iTunes</a>
        |&nbsp;<a class="capstonebarlink" href="https://open.spotify.com/show/1Yedsm23LoF35w6LyivMmh" target="_blank">Spotify</a>
        |&nbsp;<a class="capstonebarlink" href="https://overcast.fm/itunes1492373157/hope-this-helps" target="_blank">Overcast</a>
        |&nbsp;<a class="capstonebarlink" href="https://twitter.com/HTHTHEPODCAST" target="_blank">Twitter</a>
        |&nbsp;<a class="capstonebarlink" href="https://www.twitch.tv/hopethishelps" target="_blank">Twitch</a>
        |&nbsp;<a class="capstonebarlink" href="https://anchor.fm/s/11b35770/podcast/rss" target="_blank">RSS</a>
		|&nbsp;<a class="capstonebarlink" href="https://reddit.com/r/hopethishelpspodcast" target="_blank">Reddit</a>
    </p>

	</div>

</div>




<div id="main_wrapper">

<div id = "header">
	<div id = "header_inner">

    <a href="../index.html"><img src="../images/logo.PNG" class="banner" alt="Logo"></a><br /><br />
    <!--If you want to use the image map code (commented out at bottom), add  usemap="#bannermap" to the end of the above image code.-->

    		<!-- Begin Navigation -->
            <!--The Rollover inserts are just for show, remove/insert them however you want.-->
            <div class="topnavbar" style="text-align:center;">
                <a href="../about.html" class="menuanchorclass" >About</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="../shownotes/index.html" class="menuanchorclass2" data-id="anylinkmenu1">Show Notes</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="../codesnippets/index.html" class="menuanchorclass3" >Code Snippets</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				<a href="../blog/index.html" class="menuanchorclass4" >Blog</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="../live.html" class="menuanchorclass5" >Live</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </div>
            <!-- End Navigation -->

    </div>
</div>

<!-- <div id = "nav">

	<div id = "nav_inner">

		<p><a class="leftnavlink" href="#">Link here</a></p>

	</div>

</div> -->

<div id = "content">

	<div id = "content_inner">

    <h2>PowerShell Advanced Functions</h2>

    <h3>Author: Steve</h3>

    <p>Do you have a lot of chunks of code that a) perform well and b) you tend to copy/paste everywhere? Code like this is perfect for turning into functions. In PowerShell, there is the concept of Advanced Functions which take advantage of built-in features of PowerShell such as piping, output streams, error handling, and so much more.</p>

    <p>I think the best way to open up to this discussion is to preface this guide with an example. Open up this code in another tab to use as a reference: <a href="https://github.com/hopethishelpspc/hopethishelpspc.github.io/tree/master/codesnippets/SampleModule" target="_blank">this link</a> contains a PowerShell Module file containing an advanced function or two. In this article, I will reference portions of it to explain how it works.</p>
    
    <p>A PowerShell Advanced Function is comprised of a documentation section, parameter declarations, and then begin, process, and end blocks.</p>

    <p><img src="../images/bareadvfunction.png" style="height: 50%; width: 50%;" alt="Bare Function Layout"></a></p>

    <p>Documentation is of course incredibly important, and in a function you should utilize the built-in sections that will integrate with PowerShell's Get-Help features, making it easy to reference as a "man page" of your function.</p>

    <p><img src="../images/fndocumentation.png" style="height: 100%; width: 100%;" alt="Function Documentation"></a></p>

    <p>Next up after the documentation and initial declaration of the function is the 'param' section. Here you will define your data "inputs," or what you will specify when you are calling the function. Many things such as parameter order, requirements, validation, and parameter sets are configured here. How you do this will depend on how you want to structure your function. This important data will be used in the main portion of your function and we will discuss this below.</p>

    <p><img src="../images/fnparams.png" style="height: 50%; width: 50%;" alt="Function Parameter Block"></a></p>

    <p>If you choose, you may logically order your code in the 'begin,' 'process,' and 'end' blocks as you ese fit. To be quite honest, I usually skip the "Begin" block as it tends to be more trouble than it is worth when it comes to pipeline input and strange behavior that can occur if this code is skipped. Your mileage may vary of course, but this is just my experience.</p>

    <p>The "Process" block is where the majority of the action happens in a function. Here you will incorporate your code to perform its duty. Here is where you can tie it to the input parameters of the function specified in the "Param" section.</p>

    <p>Concluding your function is the "End" block, usually only including a return statement, which your function can spit out as the completed object...The fruits of your labor, so to speak. Depending on your return object, you might be able to use it as input for another function or data that can be manipulated or exported in a myriad of built-in PowerShell methods such as Export-CSV or Out-Gridview.</p>

    <h4>Tips:</h4>

    <ol>
        <li>Be careful about what output you are displaying during the course of the function. Don't just use "write-output" everywhere, as it will complicate the function's return stream and lead to unexpected results. Use the proper channels such as "write-verbose," "write-warning," "write-debug," and "write-error."</li>
        <li>Whenever possible, try to return a PowerShell custom object. This will make your function the most compatible with built-in features.</li>
        <li>Be careful about the use of the "break" statement in functions. It may cause unexpected termination of your code if the function call is wrapped in a try-catch block. Only use "break" when appropriate (and sparingly), and consider using booleans ("flags") to dictate when code either runs or doesn't run.</li>
    </ol>

    <p>For further information, check out Microsoft's <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_functions_advanced?view=powershell-7" target="_blank">official documentation</a> on advanced functions for a more deep dive and granular specifics.</p>

    <p>Be also sure to check out the blog post <a href="powershellmodules.html">Making PowerShell Modules</a>.</p>

    <p>Hope This Helps!</p>

	</div>

</div>



<div id = "footer">

	<div id = "footer_inner">

    <!--Javascript footer, to edit this, edit "javascript/footer.js"-->
	<script src="../javascript/footer.js"></script>

    <noscript>
    It appears you have Javascript disabled in your browser or something is blocking it.<br />
    If you enable it, this site will have extra visual features. If not, that's cool too.
    </noscript>

	</div>

</div>


</div> <!--End Main Wrapper-->

    <!--Image map for above banner, makes different regions click to different links:-->
    <!--It's way down here because if it is put up above, it creates a weird clump of space-->
    <!--This is commented out because you probably won't need this, but it's here if you do. It makes parts of the top banner clickable in areas you specify.-->
    <!--<map name="bannermap">
  	<area shape="rect" coords="0,-1,600,199" href="index.html" alt="OSIL Home"/>
    <area shape="rect" coords="600,0,1024,200" href="http://www.something.com/" alt="Something" />
	</map>-->

</body>
</html>
